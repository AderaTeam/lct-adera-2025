# Pipeline servies

Эндпоинт для соответствия ТЗ

# Описание работы алгоритма

- Дано:
    - Векторезатор: $V : Str \rightarrow \mathbb{R}^n$
    - Список топиков: $\mathbb{T} = \{x:Str\}$
    - нижний предел: $\lambda \in \mathbb{R}$

- Подготовительный этап: 

- Алгоритм
    1. На вход подаётся список отзывов $L_{reviews} = \{x:Str\}$
    2. Каждый из отзывов разбивается на подтекста (см. `../research`) $\overline{L}_{reviews} = \{x:\{a:Str\}\}$
    3. Каждый подтекст вектаризуется с помощью векторизатора $V$
    4. Над порождённым под действием $V$ пространством можно задать метрику $d: \mathbb{R^n} \times \mathbb{R^n} \rightarrow  \mathbb{R}$ (для текстовых эмбедингов себя зарекомендовала косинусное расстояние)
    5. Для каждой вектаризованной подтемы ищем наиболее близкй вектаризованный топик
    6. Убираем все топики, метрика для которых была меньше $\lambda$

# Переменые

- `SENTENCE_TRANSFORMER_MODEL_NAME` - модель для векторизации текстов
- `SENTENCE_PROCESSOR_NAME` - наименования `Spacy`-файла
- `DEVICE` - тип девайса
- `BATCH_SIZE` - размер батча для векторизации
- `SENTIMENT_MODEL_PATH` - путь к модели, определяющее настроение
- `CONFIG_PATH` - путь к конфигам
- `LOW_PROPABILITY_LIMIT` - низши лимит по вероятности

# Конфигурационный файл

- **preselected_topics** - словарь из наименоваие топика и его описания
- **stop_words** и **additional_stop_words** - списки лишних слов

# Files
Все файлы конфигураций представленны в `./example`. Их можно просто скопировать в `./` удалить из названия *example*
- `./configs.json` - файл с конфигурациями
- `./.env` - файл с переменными окружения


# Запуск

## 2. Создание конфигурационных файлов

Для настройки сервиса нужно 2 файла в папке `./ml_pipeline_service` (можно скопировать файлы из папки `examples` убрав из названий `example`):

- `.env`
- `configs.json`

## 3. Запуск контейнера

```
docker compose up --build
```
